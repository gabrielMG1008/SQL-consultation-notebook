-- BASIC SYNTAXES FOR MANIPULATING DATA GROUPS

-- EXAMPLE – COUNT(*) FUNCTION
SELECT COUNT(*) FROM T_SIP_DEPARTMENT;


-- EXAMPLE – COUNT FUNCTION (column)
SELECT COUNT(DT_TERMINO) FROM T_SIP_PROJETO;


-- EXAMPLE – COUNT(*) FUNCTION and NULL validation
SELECT COUNT(CD_PROJETO)
  FROM T_SIP_PROJETO
WHERE DT_TERMINO IS NOT NULL;


-- EXAMPLE – COUNT (column) function and DISTINCT clause
SELECT COUNT(DISTINCT CD_PROJETO)
FROM T_SIP_IMPLANTATION;


-- EXAMPLE – SUM FUNCTION (column)
SELECT SUM(VL_SALARIO_MENSAL) FROM T_SIP_FUNCIONARIO;


-- EXAMPLE – FUNCTION AVG (column) 
SELECT AVG(VL_SALARIO_MENSAL) FROM T_SIP_FUNCIONARIO;


-- EXAMPLE – FUNCTION MIN (column) 
SELECT MIN(VL_SALARIO_MENSAL) FROM T_SIP_FUNCIONARIO;


-- EXAMPLE – FUNCTION MAX (column) 
SELECT MAX(VL_SALARIO_MENSAL) FROM T_SIP_FUNCIONARIO;


-- EXAMPLE – FUNCTION STDDEV (column) 
SELECT STDDEV(VL_SALARIO_MENSAL) FROM T_SIP_FUNCIONARIO;


-- EXAMPLE – FUNCTION VARIANCE (column) 
SELECT VARIANCE(VL_SALARIO_MENSAL) FROM T_SIP_FUNCIONARIO;


-- EXAMPLE USING OTHER CODES 


-- EXAMPLE – GROUP BY 
SELECT NR_MATRICULA, 
       COUNT(CD_DEPENDENTE) "QTDE. DEPENDENTES"
  FROM T_SIP_DEPENDENTE
    GROUP BY NR_MATRICULA;


-- EXAMPLE – GROUP BY WITH GROUP FUNCTION
  SELECT CD_DEPTO,
   COUNT(NR_MATRICULA) "QTDE. FUNCIONARIOS NO DEPTO",
   SUM(VL_SALARIO_MENSAL) "TOTAL SALARIO POR DEPTO",
   ROUND(AVG(VL_SALARIO_MENSAL),2) "MEDIA SALARIAL POR DEPTO"
    FROM T_SIP_FUNCIONARIO
GROUP BY CD_DEPTO
ORDER BY CD_DEPTO;


-- EXAMPLE – GROUP BY WITH SEVERAL TABLES
SELECT F.NM_FUNCIONARIO       "FUNCIONARIO" ,
       D.NR_MATRICULA         "MATRICULA"   , 
       COUNT(D.NR_MATRICULA)  "QTDE. DEPENDENTES"
  FROM T_SIP_FUNCIONARIO F INNER JOIN T_SIP_DEPENDENTE D
       ON (F.NR_MATRICULA = D.NR_MATRICULA)
    GROUP BY F.NM_FUNCIONARIO, D.NR_MATRICULA;


-- EXEMPLE – GROUP BY WITH HAVING
  SELECT CD_DEPTO,
   COUNT(NR_MATRICULA) "QTDE. FUNCIONARIO NO DEPTO",
   SUM(VL_SALARIO_MENSAL) "TOTAL SALARIO POR DEPTO",
   ROUND(AVG(VL_SALARIO_MENSAL),2) "MEDIA SALARIAL POR DEPTO"
    FROM T_SIP_FUNCIONARIO
GROUP BY CD_DEPTO
HAVING   SUM(VL_SALARIO_MENSAL) > 10000;

